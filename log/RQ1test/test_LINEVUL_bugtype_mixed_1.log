01/01/2024 18:04:39 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at /data2/chenlida/model/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.dense.weight', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01/01/2024 18:04:42 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/train.jsonl', output_dir='./saved_models_RQ1/LINEVUL_bugtype_mixed', model_type='roberta', block_size=512, eval_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/valid.jsonl', test_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/test.jsonl', model_name='model.bin', model_name_or_path='/data2/chenlida/model/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='/data2/chenlida/model/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, eval_export=False, sample=False, no_cuda=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=1, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
>>>>>>>>>
./saved_models_RQ1/LINEVUL_bugtype_mixed/checkpoint-best-f1/model.bin
>>>>>>>>>>

load dataset:   0%|          | 0/14440 [00:00<?, ?it/s]load dataset:   0%|          | 46/14440 [00:00<00:31, 459.78it/s]load dataset:   1%|          | 122/14440 [00:00<00:22, 634.63it/s]load dataset:   1%|▏         | 203/14440 [00:00<00:20, 706.31it/s]load dataset:   2%|▏         | 277/14440 [00:00<00:19, 718.95it/s]load dataset:   2%|▏         | 356/14440 [00:00<00:18, 742.56it/s]load dataset:   3%|▎         | 431/14440 [00:00<00:19, 723.30it/s]load dataset:   3%|▎         | 504/14440 [00:00<00:21, 661.85it/s]load dataset:   4%|▍         | 572/14440 [00:00<00:22, 611.00it/s]load dataset:   4%|▍         | 643/14440 [00:00<00:21, 633.43it/s]load dataset:   5%|▍         | 708/14440 [00:01<00:21, 631.03it/s]load dataset:   5%|▌         | 776/14440 [00:01<00:21, 637.44it/s]load dataset:   6%|▌         | 841/14440 [00:01<00:27, 492.23it/s]load dataset:   6%|▋         | 920/14440 [00:01<00:23, 563.41it/s]load dataset:   7%|▋         | 984/14440 [00:01<00:23, 582.27it/s]load dataset:   7%|▋         | 1051/14440 [00:01<00:22, 594.37it/s]load dataset:   8%|▊         | 1114/14440 [00:01<00:23, 570.06it/s]load dataset:   8%|▊         | 1174/14440 [00:01<00:23, 568.03it/s]load dataset:   9%|▊         | 1233/14440 [00:02<00:24, 532.01it/s]load dataset:   9%|▉         | 1288/14440 [00:02<00:26, 503.77it/s]load dataset:   9%|▉         | 1360/14440 [00:02<00:24, 526.87it/s]load dataset:  10%|▉         | 1425/14440 [00:02<00:23, 558.36it/s]load dataset:  10%|█         | 1488/14440 [00:02<00:22, 575.90it/s]load dataset:  11%|█         | 1573/14440 [00:02<00:19, 650.83it/s]load dataset:  11%|█▏        | 1640/14440 [00:02<00:20, 623.78it/s]load dataset:  12%|█▏        | 1719/14440 [00:02<00:19, 665.21it/s]load dataset:  12%|█▏        | 1794/14440 [00:02<00:18, 687.56it/s]load dataset:  13%|█▎        | 1893/14440 [00:03<00:16, 767.71it/s]load dataset:  14%|█▍        | 1995/14440 [00:03<00:14, 839.83it/s]load dataset:  14%|█▍        | 2080/14440 [00:03<00:16, 730.79it/s]load dataset:  15%|█▌        | 2186/14440 [00:03<00:15, 816.63it/s]load dataset:  16%|█▌        | 2283/14440 [00:03<00:14, 858.71it/s]load dataset:  16%|█▋        | 2376/14440 [00:03<00:13, 867.79it/s]load dataset:  17%|█▋        | 2465/14440 [00:03<00:14, 853.69it/s]load dataset:  18%|█▊        | 2560/14440 [00:03<00:13, 875.79it/s]load dataset:  18%|█▊        | 2665/14440 [00:03<00:12, 925.32it/s]load dataset:  19%|█▉        | 2759/14440 [00:04<00:12, 903.93it/s]load dataset:  20%|█▉        | 2851/14440 [00:04<00:13, 836.25it/s]load dataset:  20%|██        | 2936/14440 [00:04<00:15, 744.59it/s]load dataset:  21%|██        | 3024/14440 [00:04<00:14, 778.59it/s]load dataset:  22%|██▏       | 3105/14440 [00:04<00:14, 774.57it/s]load dataset:  22%|██▏       | 3208/14440 [00:04<00:13, 842.29it/s]load dataset:  23%|██▎       | 3294/14440 [00:04<00:13, 845.07it/s]load dataset:  23%|██▎       | 3380/14440 [00:04<00:13, 830.00it/s]load dataset:  24%|██▍       | 3464/14440 [00:04<00:13, 794.27it/s]load dataset:  25%|██▍       | 3545/14440 [00:05<00:14, 769.58it/s]load dataset:  25%|██▌       | 3623/14440 [00:05<00:15, 708.09it/s]load dataset:  26%|██▌       | 3695/14440 [00:05<00:15, 701.90it/s]load dataset:  26%|██▌       | 3771/14440 [00:05<00:14, 717.58it/s]load dataset:  27%|██▋       | 3863/14440 [00:05<00:13, 773.10it/s]load dataset:  27%|██▋       | 3958/14440 [00:05<00:12, 822.34it/s]load dataset:  28%|██▊       | 4057/14440 [00:05<00:11, 869.54it/s]load dataset:  29%|██▊       | 4145/14440 [00:05<00:12, 795.48it/s]load dataset:  29%|██▉       | 4227/14440 [00:05<00:13, 758.17it/s]load dataset:  30%|██▉       | 4305/14440 [00:06<00:13, 724.98it/s]load dataset:  30%|███       | 4379/14440 [00:06<00:13, 722.03it/s]load dataset:  31%|███       | 4452/14440 [00:06<00:14, 682.39it/s]load dataset:  31%|███▏      | 4533/14440 [00:06<00:13, 716.43it/s]load dataset:  32%|███▏      | 4606/14440 [00:06<00:13, 717.64it/s]load dataset:  32%|███▏      | 4679/14440 [00:06<00:14, 687.66it/s]load dataset:  33%|███▎      | 4767/14440 [00:06<00:13, 740.89it/s]load dataset:  34%|███▎      | 4843/14440 [00:06<00:12, 746.09it/s]load dataset:  34%|███▍      | 4919/14440 [00:06<00:13, 690.14it/s]load dataset:  35%|███▍      | 4990/14440 [00:07<00:14, 639.29it/s]load dataset:  35%|███▌      | 5073/14440 [00:07<00:13, 685.07it/s]load dataset:  36%|███▌      | 5143/14440 [00:07<00:14, 640.87it/s]load dataset:  36%|███▌      | 5209/14440 [00:07<00:16, 548.19it/s]load dataset:  36%|███▋      | 5267/14440 [00:07<00:21, 432.47it/s]load dataset:  37%|███▋      | 5328/14440 [00:07<00:19, 469.27it/s]load dataset:  37%|███▋      | 5392/14440 [00:07<00:17, 505.15it/s]load dataset:  38%|███▊      | 5457/14440 [00:07<00:16, 538.33it/s]load dataset:  39%|███▊      | 5566/14440 [00:08<00:13, 680.23it/s]load dataset:  39%|███▉      | 5653/14440 [00:08<00:12, 731.31it/s]load dataset:  40%|███▉      | 5730/14440 [00:08<00:13, 652.09it/s]load dataset:  40%|████      | 5800/14440 [00:08<00:14, 615.76it/s]load dataset:  41%|████      | 5869/14440 [00:08<00:13, 628.50it/s]load dataset:  41%|████      | 5935/14440 [00:08<00:15, 542.71it/s]load dataset:  42%|████▏     | 6008/14440 [00:08<00:14, 586.45it/s]load dataset:  42%|████▏     | 6070/14440 [00:09<00:18, 451.97it/s]load dataset:  42%|████▏     | 6122/14440 [00:09<00:18, 442.16it/s]load dataset:  43%|████▎     | 6177/14440 [00:09<00:17, 464.45it/s]load dataset:  43%|████▎     | 6233/14440 [00:09<00:17, 478.11it/s]load dataset:  44%|████▎     | 6284/14440 [00:09<00:17, 474.75it/s]load dataset:  44%|████▍     | 6357/14440 [00:09<00:15, 538.65it/s]load dataset:  44%|████▍     | 6419/14440 [00:09<00:14, 560.16it/s]load dataset:  45%|████▍     | 6479/14440 [00:09<00:13, 570.10it/s]load dataset:  45%|████▌     | 6538/14440 [00:10<00:18, 421.17it/s]load dataset:  46%|████▌     | 6613/14440 [00:10<00:15, 489.70it/s]load dataset:  46%|████▌     | 6669/14440 [00:10<00:20, 375.69it/s]load dataset:  47%|████▋     | 6739/14440 [00:10<00:17, 441.84it/s]load dataset:  47%|████▋     | 6799/14440 [00:10<00:16, 458.07it/s]load dataset:  48%|████▊     | 6895/14440 [00:10<00:13, 576.89it/s]load dataset:  48%|████▊     | 6979/14440 [00:10<00:12, 620.52it/s]load dataset:  49%|████▉     | 7060/14440 [00:10<00:11, 668.92it/s]load dataset:  49%|████▉     | 7134/14440 [00:11<00:10, 687.81it/s]load dataset:  50%|████▉     | 7207/14440 [00:11<00:10, 667.05it/s]load dataset:  50%|█████     | 7277/14440 [00:11<00:10, 672.50it/s]load dataset:  51%|█████     | 7347/14440 [00:11<00:10, 673.76it/s]load dataset:  51%|█████▏    | 7416/14440 [00:11<00:10, 666.04it/s]load dataset:  52%|█████▏    | 7484/14440 [00:11<00:11, 629.95it/s]load dataset:  52%|█████▏    | 7548/14440 [00:11<00:11, 590.71it/s]load dataset:  53%|█████▎    | 7609/14440 [00:11<00:15, 443.18it/s]load dataset:  53%|█████▎    | 7660/14440 [00:12<00:16, 419.48it/s]load dataset:  54%|█████▎    | 7731/14440 [00:12<00:13, 484.53it/s]load dataset:  54%|█████▍    | 7787/14440 [00:12<00:13, 502.24it/s]load dataset:  54%|█████▍    | 7852/14440 [00:12<00:12, 538.90it/s]load dataset:  55%|█████▌    | 7944/14440 [00:12<00:10, 641.16it/s]load dataset:  55%|█████▌    | 8012/14440 [00:12<00:09, 644.09it/s]load dataset:  56%|█████▌    | 8089/14440 [00:12<00:09, 678.24it/s]load dataset:  57%|█████▋    | 8165/14440 [00:12<00:09, 693.81it/s]load dataset:  57%|█████▋    | 8236/14440 [00:12<00:10, 570.55it/s]load dataset:  57%|█████▋    | 8302/14440 [00:13<00:10, 592.68it/s]load dataset:  58%|█████▊    | 8365/14440 [00:13<00:12, 475.33it/s]load dataset:  59%|█████▊    | 8476/14440 [00:13<00:09, 618.09it/s]load dataset:  59%|█████▉    | 8546/14440 [00:13<00:09, 625.91it/s]load dataset:  60%|█████▉    | 8640/14440 [00:13<00:08, 704.85it/s]load dataset:  60%|██████    | 8722/14440 [00:13<00:07, 735.43it/s]load dataset:  61%|██████    | 8811/14440 [00:13<00:07, 776.55it/s]load dataset:  62%|██████▏   | 8893/14440 [00:13<00:07, 788.31it/s]load dataset:  62%|██████▏   | 8982/14440 [00:13<00:06, 814.09it/s]load dataset:  63%|██████▎   | 9068/14440 [00:14<00:06, 825.31it/s]load dataset:  63%|██████▎   | 9152/14440 [00:14<00:06, 816.96it/s]load dataset:  64%|██████▍   | 9242/14440 [00:14<00:06, 835.84it/s]load dataset:  65%|██████▍   | 9329/14440 [00:14<00:06, 831.65it/s]load dataset:  65%|██████▌   | 9413/14440 [00:14<00:06, 747.80it/s]load dataset:  66%|██████▌   | 9521/14440 [00:14<00:05, 837.08it/s]load dataset:  67%|██████▋   | 9607/14440 [00:14<00:06, 783.72it/s]load dataset:  67%|██████▋   | 9700/14440 [00:14<00:05, 822.85it/s]load dataset:  68%|██████▊   | 9785/14440 [00:14<00:06, 747.29it/s]load dataset:  69%|██████▊   | 9892/14440 [00:15<00:05, 830.95it/s]load dataset:  69%|██████▉   | 9998/14440 [00:15<00:04, 890.41it/s]load dataset:  70%|██████▉   | 10092/14440 [00:15<00:04, 900.32it/s]load dataset:  71%|███████   | 10184/14440 [00:15<00:04, 853.89it/s]load dataset:  71%|███████   | 10272/14440 [00:15<00:04, 841.25it/s]load dataset:  72%|███████▏  | 10358/14440 [00:15<00:05, 808.39it/s]load dataset:  72%|███████▏  | 10440/14440 [00:15<00:05, 787.91it/s]load dataset:  73%|███████▎  | 10520/14440 [00:15<00:05, 775.74it/s]load dataset:  73%|███████▎  | 10602/14440 [00:15<00:04, 788.00it/s]load dataset:  74%|███████▍  | 10700/14440 [00:16<00:04, 838.17it/s]load dataset:  75%|███████▍  | 10785/14440 [00:16<00:04, 786.09it/s]load dataset:  75%|███████▌  | 10874/14440 [00:16<00:04, 813.97it/s]load dataset:  76%|███████▌  | 10963/14440 [00:16<00:04, 833.66it/s]load dataset:  77%|███████▋  | 11048/14440 [00:16<00:04, 817.10it/s]load dataset:  77%|███████▋  | 11146/14440 [00:16<00:03, 855.90it/s]load dataset:  78%|███████▊  | 11235/14440 [00:16<00:03, 864.82it/s]load dataset:  78%|███████▊  | 11326/14440 [00:16<00:03, 876.75it/s]load dataset:  79%|███████▉  | 11425/14440 [00:16<00:03, 908.05it/s]load dataset:  80%|███████▉  | 11517/14440 [00:17<00:03, 852.37it/s]load dataset:  80%|████████  | 11609/14440 [00:17<00:03, 870.98it/s]load dataset:  81%|████████  | 11697/14440 [00:17<00:03, 798.11it/s]load dataset:  82%|████████▏ | 11788/14440 [00:17<00:03, 827.10it/s]load dataset:  82%|████████▏ | 11878/14440 [00:17<00:03, 833.25it/s]load dataset:  83%|████████▎ | 11963/14440 [00:17<00:02, 827.65it/s]load dataset:  83%|████████▎ | 12047/14440 [00:17<00:03, 680.00it/s]load dataset:  84%|████████▍ | 12120/14440 [00:17<00:03, 673.87it/s]load dataset:  84%|████████▍ | 12200/14440 [00:17<00:03, 704.14it/s]load dataset:  85%|████████▌ | 12292/14440 [00:18<00:02, 761.50it/s]load dataset:  86%|████████▌ | 12384/14440 [00:18<00:02, 804.26it/s]load dataset:  86%|████████▋ | 12467/14440 [00:18<00:02, 773.44it/s]load dataset:  87%|████████▋ | 12546/14440 [00:18<00:02, 693.91it/s]load dataset:  87%|████████▋ | 12618/14440 [00:18<00:02, 661.95it/s]load dataset:  88%|████████▊ | 12686/14440 [00:18<00:02, 651.90it/s]load dataset:  89%|████████▊ | 12783/14440 [00:18<00:02, 736.51it/s]load dataset:  89%|████████▉ | 12879/14440 [00:18<00:01, 794.84it/s]load dataset:  90%|████████▉ | 12961/14440 [00:18<00:02, 715.08it/s]load dataset:  90%|█████████ | 13042/14440 [00:19<00:01, 739.84it/s]load dataset:  91%|█████████ | 13119/14440 [00:19<00:01, 744.12it/s]load dataset:  91%|█████████▏| 13195/14440 [00:19<00:01, 681.77it/s]load dataset:  92%|█████████▏| 13266/14440 [00:19<00:01, 688.07it/s]load dataset:  92%|█████████▏| 13337/14440 [00:19<00:01, 629.20it/s]load dataset:  93%|█████████▎| 13402/14440 [00:19<00:01, 587.67it/s]load dataset:  93%|█████████▎| 13463/14440 [00:19<00:01, 580.62it/s]load dataset:  94%|█████████▎| 13522/14440 [00:19<00:01, 522.31it/s]load dataset:  94%|█████████▍| 13598/14440 [00:20<00:01, 579.43it/s]load dataset:  95%|█████████▍| 13658/14440 [00:20<00:01, 396.89it/s]load dataset:  95%|█████████▍| 13707/14440 [00:20<00:02, 359.43it/s]load dataset:  95%|█████████▌| 13750/14440 [00:20<00:01, 359.30it/s]load dataset:  96%|█████████▌| 13794/14440 [00:20<00:01, 370.64it/s]load dataset:  96%|█████████▌| 13835/14440 [00:20<00:01, 378.37it/s]load dataset:  96%|█████████▌| 13876/14440 [00:20<00:01, 362.05it/s]load dataset:  96%|█████████▋| 13914/14440 [00:21<00:02, 251.76it/s]load dataset:  97%|█████████▋| 13948/14440 [00:21<00:01, 264.26it/s]load dataset:  97%|█████████▋| 13979/14440 [00:21<00:02, 228.37it/s]load dataset:  97%|█████████▋| 14006/14440 [00:21<00:01, 226.65it/s]load dataset:  97%|█████████▋| 14032/14440 [00:21<00:01, 221.56it/s]load dataset:  97%|█████████▋| 14059/14440 [00:21<00:01, 228.07it/s]load dataset:  98%|█████████▊| 14084/14440 [00:22<00:01, 224.72it/s]load dataset:  98%|█████████▊| 14110/14440 [00:22<00:01, 231.33it/s]load dataset:  98%|█████████▊| 14141/14440 [00:22<00:01, 250.89it/s]load dataset:  98%|█████████▊| 14194/14440 [00:22<00:00, 326.30it/s]load dataset:  99%|█████████▊| 14228/14440 [00:22<00:00, 318.23it/s]load dataset:  99%|█████████▉| 14265/14440 [00:22<00:00, 328.79it/s]load dataset:  99%|█████████▉| 14321/14440 [00:22<00:00, 389.29it/s]load dataset:  99%|█████████▉| 14361/14440 [00:22<00:00, 347.33it/s]load dataset: 100%|█████████▉| 14397/14440 [00:22<00:00, 290.84it/s]load dataset: 100%|██████████| 14440/14440 [00:23<00:00, 322.99it/s]load dataset: 100%|██████████| 14440/14440 [00:23<00:00, 625.91it/s]
01/01/2024 18:05:08 - INFO - __main__ -   ***** Running Test *****
01/01/2024 18:05:08 - INFO - __main__ -     Num examples = 14440
01/01/2024 18:05:08 - INFO - __main__ -     Batch size = 512
evaluate test:   0%|          | 0/29 [00:00<?, ?it/s]evaluate test:   3%|▎         | 1/29 [00:09<04:37,  9.92s/it]evaluate test:   7%|▋         | 2/29 [00:17<03:45,  8.35s/it]evaluate test:  10%|█         | 3/29 [00:24<03:24,  7.86s/it]evaluate test:  14%|█▍        | 4/29 [00:31<03:11,  7.64s/it]evaluate test:  17%|█▋        | 5/29 [00:39<03:00,  7.52s/it]evaluate test:  21%|██        | 6/29 [00:46<02:51,  7.46s/it]evaluate test:  24%|██▍       | 7/29 [00:53<02:43,  7.42s/it]evaluate test:  28%|██▊       | 8/29 [01:01<02:35,  7.40s/it]evaluate test:  31%|███       | 9/29 [01:08<02:27,  7.39s/it]evaluate test:  34%|███▍      | 10/29 [01:15<02:20,  7.39s/it]evaluate test:  38%|███▊      | 11/29 [01:23<02:12,  7.38s/it]evaluate test:  41%|████▏     | 12/29 [01:30<02:05,  7.38s/it]evaluate test:  45%|████▍     | 13/29 [01:37<01:58,  7.38s/it]evaluate test:  48%|████▊     | 14/29 [01:45<01:50,  7.38s/it]evaluate test:  52%|█████▏    | 15/29 [01:52<01:43,  7.39s/it]evaluate test:  55%|█████▌    | 16/29 [02:00<01:36,  7.40s/it]evaluate test:  59%|█████▊    | 17/29 [02:07<01:28,  7.39s/it]evaluate test:  62%|██████▏   | 18/29 [02:14<01:21,  7.39s/it]evaluate test:  66%|██████▌   | 19/29 [02:22<01:14,  7.40s/it]evaluate test:  69%|██████▉   | 20/29 [02:26<00:57,  6.41s/it]evaluate test:  72%|███████▏  | 21/29 [02:29<00:44,  5.54s/it]evaluate test:  76%|███████▌  | 22/29 [02:33<00:34,  4.94s/it]evaluate test:  79%|███████▉  | 23/29 [02:36<00:26,  4.47s/it]evaluate test:  83%|████████▎ | 24/29 [02:40<00:20,  4.14s/it]evaluate test:  86%|████████▌ | 25/29 [02:43<00:15,  3.92s/it]evaluate test:  90%|████████▉ | 26/29 [02:47<00:11,  3.77s/it]evaluate test:  93%|█████████▎| 27/29 [02:50<00:07,  3.67s/it]evaluate test:  97%|█████████▋| 28/29 [02:54<00:03,  3.72s/it]evaluate test: 100%|██████████| 29/29 [02:55<00:00,  3.07s/it]evaluate test: 100%|██████████| 29/29 [02:55<00:00,  6.07s/it]
01/01/2024 18:08:04 - INFO - __main__ -   ***** Test results *****
01/01/2024 18:08:04 - INFO - __main__ -     test_accuracy = 0.9823
01/01/2024 18:08:04 - INFO - __main__ -     test_f1 = 0.8356
01/01/2024 18:08:04 - INFO - __main__ -     test_precision = 0.9178
01/01/2024 18:08:04 - INFO - __main__ -     test_recall = 0.7669
01/01/2024 18:08:04 - INFO - __main__ -     test_threshold = 0.5
