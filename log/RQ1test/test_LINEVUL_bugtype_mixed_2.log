01/01/2024 18:08:09 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at /data2/chenlida/model/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.out_proj.bias', 'classifier.dense.bias', 'classifier.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01/01/2024 18:08:11 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/train.jsonl', output_dir='./saved_models_RQ1/LINEVUL_bugtype_mixed', model_type='roberta', block_size=512, eval_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/valid.jsonl', test_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/test.jsonl', model_name='model.bin', model_name_or_path='/data2/chenlida/model/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='/data2/chenlida/model/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, eval_export=False, sample=False, no_cuda=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=2, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
>>>>>>>>>
./saved_models_RQ1/LINEVUL_bugtype_mixed/checkpoint-best-f1/model.bin
>>>>>>>>>>

load dataset:   0%|          | 0/14440 [00:00<?, ?it/s]load dataset:   0%|          | 46/14440 [00:00<00:31, 449.92it/s]load dataset:   1%|          | 124/14440 [00:00<00:22, 640.77it/s]load dataset:   1%|▏         | 206/14440 [00:00<00:19, 721.42it/s]load dataset:   2%|▏         | 280/14440 [00:00<00:19, 726.92it/s]load dataset:   2%|▏         | 360/14440 [00:00<00:18, 749.59it/s]load dataset:   3%|▎         | 435/14440 [00:00<00:18, 744.15it/s]load dataset:   4%|▎         | 510/14440 [00:00<00:20, 669.85it/s]load dataset:   4%|▍         | 579/14440 [00:00<00:23, 598.26it/s]load dataset:   5%|▍         | 656/14440 [00:00<00:21, 639.84it/s]load dataset:   5%|▌         | 722/14440 [00:01<00:22, 605.00it/s]load dataset:   5%|▌         | 784/14440 [00:01<00:22, 600.45it/s]load dataset:   6%|▌         | 846/14440 [00:01<00:26, 512.54it/s]load dataset:   6%|▋         | 923/14440 [00:01<00:23, 575.88it/s]load dataset:   7%|▋         | 987/14440 [00:01<00:22, 591.83it/s]load dataset:   7%|▋         | 1051/14440 [00:01<00:22, 602.62it/s]load dataset:   8%|▊         | 1114/14440 [00:01<00:23, 579.33it/s]load dataset:   8%|▊         | 1174/14440 [00:01<00:23, 568.31it/s]load dataset:   9%|▊         | 1232/14440 [00:02<00:24, 532.19it/s]load dataset:   9%|▉         | 1287/14440 [00:02<00:26, 502.92it/s]load dataset:   9%|▉         | 1360/14440 [00:02<00:24, 528.35it/s]load dataset:  10%|▉         | 1428/14440 [00:02<00:23, 558.02it/s]load dataset:  10%|█         | 1491/14440 [00:02<00:22, 576.96it/s]load dataset:  11%|█         | 1578/14440 [00:02<00:19, 657.91it/s]load dataset:  11%|█▏        | 1645/14440 [00:02<00:20, 621.40it/s]load dataset:  12%|█▏        | 1724/14440 [00:02<00:19, 666.26it/s]load dataset:  13%|█▎        | 1807/14440 [00:02<00:17, 710.24it/s]load dataset:  13%|█▎        | 1904/14440 [00:03<00:15, 783.76it/s]load dataset:  14%|█▍        | 2005/14440 [00:03<00:14, 848.02it/s]load dataset:  14%|█▍        | 2091/14440 [00:03<00:16, 750.20it/s]load dataset:  15%|█▌        | 2194/14440 [00:03<00:14, 825.44it/s]load dataset:  16%|█▌        | 2289/14440 [00:03<00:14, 859.52it/s]load dataset:  16%|█▋        | 2381/14440 [00:03<00:14, 852.97it/s]load dataset:  17%|█▋        | 2469/14440 [00:03<00:13, 860.19it/s]load dataset:  18%|█▊        | 2562/14440 [00:03<00:13, 878.09it/s]load dataset:  18%|█▊        | 2667/14440 [00:03<00:12, 927.37it/s]load dataset:  19%|█▉        | 2761/14440 [00:03<00:12, 899.46it/s]load dataset:  20%|█▉        | 2852/14440 [00:04<00:13, 833.44it/s]load dataset:  20%|██        | 2937/14440 [00:04<00:15, 741.95it/s]load dataset:  21%|██        | 3025/14440 [00:04<00:14, 777.14it/s]load dataset:  22%|██▏       | 3105/14440 [00:04<00:14, 775.21it/s]load dataset:  22%|██▏       | 3208/14440 [00:04<00:13, 845.47it/s]load dataset:  23%|██▎       | 3295/14440 [00:04<00:13, 848.43it/s]load dataset:  23%|██▎       | 3382/14440 [00:04<00:13, 827.29it/s]load dataset:  24%|██▍       | 3466/14440 [00:04<00:13, 798.34it/s]load dataset:  25%|██▍       | 3547/14440 [00:05<00:14, 770.88it/s]load dataset:  25%|██▌       | 3625/14440 [00:05<00:15, 706.20it/s]load dataset:  26%|██▌       | 3697/14440 [00:05<00:15, 698.95it/s]load dataset:  26%|██▌       | 3775/14440 [00:05<00:14, 714.54it/s]load dataset:  27%|██▋       | 3867/14440 [00:05<00:13, 769.75it/s]load dataset:  28%|██▊       | 3971/14440 [00:05<00:12, 846.17it/s]load dataset:  28%|██▊       | 4062/14440 [00:05<00:12, 862.81it/s]load dataset:  29%|██▊       | 4150/14440 [00:05<00:13, 790.11it/s]load dataset:  29%|██▉       | 4231/14440 [00:05<00:13, 764.14it/s]load dataset:  30%|██▉       | 4309/14440 [00:06<00:13, 734.57it/s]load dataset:  30%|███       | 4384/14440 [00:06<00:13, 724.56it/s]load dataset:  31%|███       | 4458/14440 [00:06<00:14, 700.50it/s]load dataset:  31%|███▏      | 4536/14440 [00:06<00:13, 721.66it/s]load dataset:  32%|███▏      | 4616/14440 [00:06<00:13, 740.27it/s]load dataset:  32%|███▏      | 4691/14440 [00:06<00:13, 699.08it/s]load dataset:  33%|███▎      | 4784/14440 [00:06<00:12, 761.60it/s]load dataset:  34%|███▍      | 4877/14440 [00:06<00:11, 806.43it/s]load dataset:  34%|███▍      | 4959/14440 [00:06<00:12, 757.66it/s]load dataset:  35%|███▍      | 5041/14440 [00:07<00:12, 772.19it/s]load dataset:  35%|███▌      | 5120/14440 [00:07<00:12, 720.45it/s]load dataset:  36%|███▌      | 5194/14440 [00:07<00:15, 593.32it/s]load dataset:  36%|███▋      | 5258/14440 [00:07<00:20, 458.40it/s]load dataset:  37%|███▋      | 5323/14440 [00:07<00:18, 495.76it/s]load dataset:  37%|███▋      | 5392/14440 [00:07<00:17, 526.04it/s]load dataset:  38%|███▊      | 5457/14440 [00:07<00:16, 552.04it/s]load dataset:  39%|███▊      | 5566/14440 [00:07<00:12, 688.84it/s]load dataset:  39%|███▉      | 5654/14440 [00:08<00:11, 735.30it/s]load dataset:  40%|███▉      | 5732/14440 [00:08<00:13, 662.64it/s]load dataset:  40%|████      | 5803/14440 [00:08<00:13, 621.46it/s]load dataset:  41%|████      | 5870/14440 [00:08<00:13, 631.29it/s]load dataset:  41%|████      | 5936/14440 [00:08<00:15, 544.54it/s]load dataset:  42%|████▏     | 6008/14440 [00:08<00:14, 585.01it/s]load dataset:  42%|████▏     | 6070/14440 [00:08<00:18, 451.83it/s]load dataset:  42%|████▏     | 6122/14440 [00:09<00:18, 443.43it/s]load dataset:  43%|████▎     | 6176/14440 [00:09<00:17, 464.75it/s]load dataset:  43%|████▎     | 6230/14440 [00:09<00:17, 482.32it/s]load dataset:  44%|████▎     | 6282/14440 [00:09<00:17, 474.47it/s]load dataset:  44%|████▍     | 6353/14440 [00:09<00:15, 535.70it/s]load dataset:  44%|████▍     | 6412/14440 [00:09<00:14, 547.99it/s]load dataset:  45%|████▍     | 6469/14440 [00:09<00:14, 531.81it/s]load dataset:  45%|████▌     | 6524/14440 [00:09<00:21, 362.61it/s]load dataset:  46%|████▌     | 6594/14440 [00:10<00:18, 432.71it/s]load dataset:  46%|████▌     | 6646/14440 [00:10<00:23, 335.13it/s]load dataset:  46%|████▋     | 6708/14440 [00:10<00:19, 390.67it/s]load dataset:  47%|████▋     | 6775/14440 [00:10<00:16, 451.25it/s]load dataset:  47%|████▋     | 6829/14440 [00:10<00:16, 469.45it/s]load dataset:  48%|████▊     | 6945/14440 [00:10<00:11, 643.23it/s]load dataset:  49%|████▊     | 7018/14440 [00:10<00:11, 641.54it/s]load dataset:  49%|████▉     | 7115/14440 [00:10<00:10, 727.76it/s]load dataset:  50%|████▉     | 7193/14440 [00:11<00:10, 682.07it/s]load dataset:  50%|█████     | 7266/14440 [00:11<00:10, 663.67it/s]load dataset:  51%|█████     | 7340/14440 [00:11<00:10, 677.46it/s]load dataset:  51%|█████▏    | 7410/14440 [00:11<00:10, 662.73it/s]load dataset:  52%|█████▏    | 7478/14440 [00:11<00:11, 631.30it/s]load dataset:  52%|█████▏    | 7543/14440 [00:11<00:11, 611.25it/s]load dataset:  53%|█████▎    | 7605/14440 [00:11<00:15, 448.81it/s]load dataset:  53%|█████▎    | 7657/14440 [00:12<00:15, 424.59it/s]load dataset:  54%|█████▎    | 7730/14440 [00:12<00:13, 490.69it/s]load dataset:  54%|█████▍    | 7785/14440 [00:12<00:13, 504.53it/s]load dataset:  54%|█████▍    | 7851/14440 [00:12<00:12, 543.30it/s]load dataset:  55%|█████▌    | 7943/14440 [00:12<00:10, 640.13it/s]load dataset:  55%|█████▌    | 8011/14440 [00:12<00:09, 644.67it/s]load dataset:  56%|█████▌    | 8090/14440 [00:12<00:09, 682.83it/s]load dataset:  57%|█████▋    | 8165/14440 [00:12<00:08, 698.18it/s]load dataset:  57%|█████▋    | 8237/14440 [00:12<00:10, 573.97it/s]load dataset:  58%|█████▊    | 8304/14440 [00:13<00:10, 597.50it/s]load dataset:  58%|█████▊    | 8368/14440 [00:13<00:12, 479.65it/s]load dataset:  59%|█████▊    | 8476/14440 [00:13<00:09, 616.95it/s]load dataset:  59%|█████▉    | 8547/14440 [00:13<00:09, 625.89it/s]load dataset:  60%|█████▉    | 8641/14440 [00:13<00:08, 697.35it/s]load dataset:  60%|██████    | 8730/14440 [00:13<00:07, 745.25it/s]load dataset:  61%|██████    | 8813/14440 [00:13<00:07, 766.17it/s]load dataset:  62%|██████▏   | 8901/14440 [00:13<00:06, 797.68it/s]load dataset:  62%|██████▏   | 8994/14440 [00:13<00:06, 817.19it/s]load dataset:  63%|██████▎   | 9078/14440 [00:14<00:06, 821.05it/s]load dataset:  64%|██████▎   | 9171/14440 [00:14<00:06, 849.25it/s]load dataset:  64%|██████▍   | 9257/14440 [00:14<00:06, 827.69it/s]load dataset:  65%|██████▍   | 9341/14440 [00:14<00:06, 826.03it/s]load dataset:  65%|██████▌   | 9425/14440 [00:14<00:06, 758.66it/s]load dataset:  66%|██████▌   | 9531/14440 [00:14<00:05, 820.91it/s]load dataset:  67%|██████▋   | 9615/14440 [00:14<00:05, 805.28it/s]load dataset:  67%|██████▋   | 9714/14440 [00:14<00:05, 854.62it/s]load dataset:  68%|██████▊   | 9801/14440 [00:14<00:05, 778.75it/s]load dataset:  69%|██████▊   | 9903/14440 [00:15<00:05, 843.29it/s]load dataset:  69%|██████▉   | 10013/14440 [00:15<00:04, 909.96it/s]load dataset:  70%|██████▉   | 10106/14440 [00:15<00:04, 894.68it/s]load dataset:  71%|███████   | 10197/14440 [00:15<00:04, 855.80it/s]load dataset:  71%|███████   | 10284/14440 [00:15<00:04, 842.36it/s]load dataset:  72%|███████▏  | 10369/14440 [00:15<00:05, 793.79it/s]load dataset:  72%|███████▏  | 10450/14440 [00:15<00:05, 787.99it/s]load dataset:  73%|███████▎  | 10530/14440 [00:15<00:04, 790.59it/s]load dataset:  74%|███████▎  | 10615/14440 [00:15<00:04, 806.60it/s]load dataset:  74%|███████▍  | 10705/14440 [00:16<00:04, 818.61it/s]load dataset:  75%|███████▍  | 10788/14440 [00:16<00:04, 791.64it/s]load dataset:  75%|███████▌  | 10883/14440 [00:16<00:04, 835.11it/s]load dataset:  76%|███████▌  | 10972/14440 [00:16<00:04, 850.23it/s]load dataset:  77%|███████▋  | 11058/14440 [00:16<00:04, 821.84it/s]load dataset:  77%|███████▋  | 11153/14440 [00:16<00:03, 857.33it/s]load dataset:  78%|███████▊  | 11248/14440 [00:16<00:03, 883.41it/s]load dataset:  79%|███████▊  | 11344/14440 [00:16<00:03, 905.17it/s]load dataset:  79%|███████▉  | 11437/14440 [00:16<00:03, 908.88it/s]load dataset:  80%|███████▉  | 11529/14440 [00:16<00:03, 862.64it/s]load dataset:  80%|████████  | 11616/14440 [00:17<00:03, 843.83it/s]load dataset:  81%|████████  | 11701/14440 [00:17<00:03, 814.30it/s]load dataset:  82%|████████▏ | 11792/14440 [00:17<00:03, 840.86it/s]load dataset:  82%|████████▏ | 11878/14440 [00:17<00:03, 838.77it/s]load dataset:  83%|████████▎ | 11974/14440 [00:17<00:02, 872.17it/s]load dataset:  84%|████████▎ | 12062/14440 [00:17<00:02, 800.26it/s]load dataset:  84%|████████▍ | 12151/14440 [00:17<00:02, 824.48it/s]load dataset:  85%|████████▍ | 12235/14440 [00:17<00:02, 807.66it/s]load dataset:  85%|████████▌ | 12317/14440 [00:17<00:02, 802.95it/s]load dataset:  86%|████████▌ | 12408/14440 [00:18<00:02, 826.25it/s]load dataset:  87%|████████▋ | 12492/14440 [00:18<00:02, 750.95it/s]load dataset:  87%|████████▋ | 12569/14440 [00:18<00:02, 706.48it/s]load dataset:  88%|████████▊ | 12641/14440 [00:18<00:02, 693.48it/s]load dataset:  88%|████████▊ | 12712/14440 [00:18<00:02, 692.40it/s]load dataset:  89%|████████▊ | 12805/14440 [00:18<00:02, 758.18it/s]load dataset:  89%|████████▉ | 12889/14440 [00:18<00:01, 780.85it/s]load dataset:  90%|████████▉ | 12968/14440 [00:18<00:02, 715.70it/s]load dataset:  90%|█████████ | 13046/14440 [00:18<00:01, 732.17it/s]load dataset:  91%|█████████ | 13124/14440 [00:19<00:01, 742.34it/s]load dataset:  91%|█████████▏| 13200/14440 [00:19<00:01, 692.35it/s]load dataset:  92%|█████████▏| 13271/14440 [00:19<00:01, 694.72it/s]load dataset:  92%|█████████▏| 13342/14440 [00:19<00:01, 624.41it/s]load dataset:  93%|█████████▎| 13407/14440 [00:19<00:01, 586.64it/s]load dataset:  93%|█████████▎| 13468/14440 [00:19<00:01, 564.17it/s]load dataset:  94%|█████████▎| 13526/14440 [00:19<00:01, 519.19it/s]load dataset:  94%|█████████▍| 13601/14440 [00:19<00:01, 577.22it/s]load dataset:  95%|█████████▍| 13661/14440 [00:20<00:01, 393.26it/s]load dataset:  95%|█████████▍| 13710/14440 [00:20<00:02, 342.25it/s]load dataset:  95%|█████████▌| 13751/14440 [00:20<00:02, 324.56it/s]load dataset:  96%|█████████▌| 13794/14440 [00:20<00:01, 344.08it/s]load dataset:  96%|█████████▌| 13835/14440 [00:20<00:01, 356.57it/s]load dataset:  96%|█████████▌| 13874/14440 [00:20<00:01, 349.76it/s]load dataset:  96%|█████████▋| 13912/14440 [00:21<00:02, 253.30it/s]load dataset:  97%|█████████▋| 13945/14440 [00:21<00:01, 268.69it/s]load dataset:  97%|█████████▋| 13977/14440 [00:21<00:02, 222.30it/s]load dataset:  97%|█████████▋| 14004/14440 [00:21<00:01, 220.22it/s]load dataset:  97%|█████████▋| 14032/14440 [00:21<00:01, 219.15it/s]load dataset:  97%|█████████▋| 14059/14440 [00:21<00:01, 226.02it/s]load dataset:  98%|█████████▊| 14084/14440 [00:21<00:01, 224.27it/s]load dataset:  98%|█████████▊| 14110/14440 [00:22<00:01, 231.09it/s]load dataset:  98%|█████████▊| 14141/14440 [00:22<00:01, 250.50it/s]load dataset:  98%|█████████▊| 14194/14440 [00:22<00:00, 325.50it/s]load dataset:  99%|█████████▊| 14228/14440 [00:22<00:00, 317.40it/s]load dataset:  99%|█████████▉| 14265/14440 [00:22<00:00, 328.27it/s]load dataset:  99%|█████████▉| 14321/14440 [00:22<00:00, 389.16it/s]load dataset:  99%|█████████▉| 14361/14440 [00:22<00:00, 346.18it/s]load dataset: 100%|█████████▉| 14397/14440 [00:22<00:00, 290.30it/s]load dataset: 100%|██████████| 14440/14440 [00:22<00:00, 323.02it/s]load dataset: 100%|██████████| 14440/14440 [00:22<00:00, 628.75it/s]
01/01/2024 18:08:39 - INFO - __main__ -   ***** Running Test *****
01/01/2024 18:08:39 - INFO - __main__ -     Num examples = 14440
01/01/2024 18:08:39 - INFO - __main__ -     Batch size = 512
evaluate test:   0%|          | 0/29 [00:00<?, ?it/s]evaluate test:   3%|▎         | 1/29 [00:10<04:51, 10.43s/it]evaluate test:   7%|▋         | 2/29 [00:17<03:54,  8.69s/it]evaluate test:  10%|█         | 3/29 [00:25<03:31,  8.12s/it]evaluate test:  14%|█▍        | 4/29 [00:32<03:16,  7.85s/it]evaluate test:  17%|█▋        | 5/29 [00:40<03:04,  7.69s/it]evaluate test:  21%|██        | 6/29 [00:47<02:54,  7.60s/it]evaluate test:  24%|██▍       | 7/29 [00:55<02:45,  7.54s/it]evaluate test:  28%|██▊       | 8/29 [01:02<02:37,  7.51s/it]evaluate test:  31%|███       | 9/29 [01:09<02:29,  7.49s/it]evaluate test:  34%|███▍      | 10/29 [01:17<02:22,  7.48s/it]evaluate test:  38%|███▊      | 11/29 [01:24<02:14,  7.49s/it]evaluate test:  41%|████▏     | 12/29 [01:29<01:51,  6.57s/it]evaluate test:  45%|████▍     | 13/29 [01:32<01:30,  5.66s/it]evaluate test:  48%|████▊     | 14/29 [01:36<01:15,  5.04s/it]evaluate test:  52%|█████▏    | 15/29 [01:39<01:03,  4.56s/it]evaluate test:  55%|█████▌    | 16/29 [01:43<00:54,  4.22s/it]evaluate test:  59%|█████▊    | 17/29 [01:46<00:47,  3.98s/it]evaluate test:  62%|██████▏   | 18/29 [01:50<00:41,  3.80s/it]evaluate test:  66%|██████▌   | 19/29 [01:53<00:36,  3.68s/it]evaluate test:  69%|██████▉   | 20/29 [01:57<00:32,  3.66s/it]evaluate test:  72%|███████▏  | 21/29 [02:04<00:37,  4.64s/it]evaluate test:  76%|███████▌  | 22/29 [02:11<00:38,  5.48s/it]evaluate test:  79%|███████▉  | 23/29 [02:19<00:36,  6.07s/it]evaluate test:  83%|████████▎ | 24/29 [02:26<00:32,  6.48s/it]evaluate test:  86%|████████▌ | 25/29 [02:33<00:27,  6.77s/it]evaluate test:  90%|████████▉ | 26/29 [02:41<00:20,  6.97s/it]evaluate test:  93%|█████████▎| 27/29 [02:48<00:14,  7.12s/it]evaluate test:  97%|█████████▋| 28/29 [02:56<00:07,  7.24s/it]evaluate test: 100%|██████████| 29/29 [02:57<00:00,  5.53s/it]evaluate test: 100%|██████████| 29/29 [02:57<00:00,  6.13s/it]
01/01/2024 18:11:37 - INFO - __main__ -   ***** Test results *****
01/01/2024 18:11:37 - INFO - __main__ -     test_accuracy = 0.9823
01/01/2024 18:11:37 - INFO - __main__ -     test_f1 = 0.8356
01/01/2024 18:11:37 - INFO - __main__ -     test_precision = 0.9178
01/01/2024 18:11:37 - INFO - __main__ -     test_recall = 0.7669
01/01/2024 18:11:37 - INFO - __main__ -     test_threshold = 0.5
