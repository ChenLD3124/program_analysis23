01/01/2024 18:11:42 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at /data2/chenlida/model/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.weight', 'classifier.dense.bias', 'classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01/01/2024 18:11:44 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/train.jsonl', output_dir='./saved_models_RQ1/LINEVUL_bugtype_mixed', model_type='roberta', block_size=512, eval_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/valid.jsonl', test_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/test.jsonl', model_name='model.bin', model_name_or_path='/data2/chenlida/model/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='/data2/chenlida/model/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, eval_export=False, sample=False, no_cuda=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=3, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
>>>>>>>>>
./saved_models_RQ1/LINEVUL_bugtype_mixed/checkpoint-best-f1/model.bin
>>>>>>>>>>

load dataset:   0%|          | 0/14440 [00:00<?, ?it/s]load dataset:   0%|          | 46/14440 [00:00<00:31, 452.27it/s]load dataset:   1%|          | 126/14440 [00:00<00:22, 649.23it/s]load dataset:   1%|▏         | 211/14440 [00:00<00:19, 738.88it/s]load dataset:   2%|▏         | 285/14440 [00:00<00:21, 667.08it/s]load dataset:   2%|▏         | 353/14440 [00:00<00:22, 631.87it/s]load dataset:   3%|▎         | 428/14440 [00:00<00:21, 662.37it/s]load dataset:   3%|▎         | 495/14440 [00:00<00:22, 618.69it/s]load dataset:   4%|▍         | 558/14440 [00:00<00:22, 610.49it/s]load dataset:   4%|▍         | 620/14440 [00:00<00:22, 608.64it/s]load dataset:   5%|▍         | 686/14440 [00:01<00:22, 621.41it/s]load dataset:   5%|▌         | 749/14440 [00:01<00:22, 615.50it/s]load dataset:   6%|▌         | 811/14440 [00:01<00:23, 590.61it/s]load dataset:   6%|▌         | 871/14440 [00:01<00:25, 525.43it/s]load dataset:   7%|▋         | 939/14440 [00:01<00:23, 564.90it/s]load dataset:   7%|▋         | 1007/14440 [00:01<00:22, 595.15it/s]load dataset:   7%|▋         | 1068/14440 [00:01<00:22, 594.37it/s]load dataset:   8%|▊         | 1131/14440 [00:01<00:22, 597.60it/s]load dataset:   8%|▊         | 1192/14440 [00:02<00:25, 525.11it/s]load dataset:   9%|▊         | 1255/14440 [00:02<00:24, 547.67it/s]load dataset:   9%|▉         | 1312/14440 [00:02<00:24, 530.50it/s]load dataset:   9%|▉         | 1367/14440 [00:02<00:24, 525.57it/s]load dataset:  10%|▉         | 1436/14440 [00:02<00:22, 569.85it/s]load dataset:  10%|█         | 1512/14440 [00:02<00:20, 623.17it/s]load dataset:  11%|█         | 1589/14440 [00:02<00:19, 664.94it/s]load dataset:  11%|█▏        | 1657/14440 [00:02<00:20, 625.03it/s]load dataset:  12%|█▏        | 1748/14440 [00:02<00:18, 703.74it/s]load dataset:  13%|█▎        | 1835/14440 [00:02<00:16, 744.32it/s]load dataset:  13%|█▎        | 1936/14440 [00:03<00:15, 819.28it/s]load dataset:  14%|█▍        | 2023/14440 [00:03<00:15, 827.50it/s]load dataset:  15%|█▍        | 2107/14440 [00:03<00:15, 776.93it/s]load dataset:  15%|█▌        | 2214/14440 [00:03<00:14, 857.58it/s]load dataset:  16%|█▌        | 2314/14440 [00:03<00:13, 897.82it/s]load dataset:  17%|█▋        | 2405/14440 [00:03<00:14, 848.48it/s]load dataset:  17%|█▋        | 2502/14440 [00:03<00:13, 880.60it/s]load dataset:  18%|█▊        | 2594/14440 [00:03<00:13, 891.10it/s]load dataset:  19%|█▊        | 2696/14440 [00:03<00:12, 907.25it/s]load dataset:  19%|█▉        | 2788/14440 [00:04<00:12, 906.32it/s]load dataset:  20%|█▉        | 2879/14440 [00:04<00:14, 787.05it/s]load dataset:  21%|██        | 2966/14440 [00:04<00:14, 808.87it/s]load dataset:  21%|██        | 3050/14440 [00:04<00:14, 777.39it/s]load dataset:  22%|██▏       | 3151/14440 [00:04<00:13, 840.48it/s]load dataset:  22%|██▏       | 3244/14440 [00:04<00:12, 862.90it/s]load dataset:  23%|██▎       | 3336/14440 [00:04<00:12, 878.84it/s]load dataset:  24%|██▎       | 3425/14440 [00:04<00:13, 814.07it/s]load dataset:  24%|██▍       | 3509/14440 [00:04<00:13, 785.97it/s]load dataset:  25%|██▍       | 3589/14440 [00:05<00:14, 750.34it/s]load dataset:  25%|██▌       | 3665/14440 [00:05<00:14, 720.23it/s]load dataset:  26%|██▌       | 3738/14440 [00:05<00:15, 706.11it/s]load dataset:  26%|██▋       | 3813/14440 [00:05<00:14, 716.76it/s]load dataset:  27%|██▋       | 3900/14440 [00:05<00:13, 757.41it/s]load dataset:  28%|██▊       | 4025/14440 [00:05<00:11, 897.71it/s]load dataset:  29%|██▊       | 4116/14440 [00:05<00:12, 813.91it/s]load dataset:  29%|██▉       | 4200/14440 [00:05<00:12, 794.83it/s]load dataset:  30%|██▉       | 4281/14440 [00:05<00:13, 777.03it/s]load dataset:  30%|███       | 4360/14440 [00:06<00:13, 728.19it/s]load dataset:  31%|███       | 4434/14440 [00:06<00:14, 699.80it/s]load dataset:  31%|███▏      | 4516/14440 [00:06<00:13, 730.55it/s]load dataset:  32%|███▏      | 4590/14440 [00:06<00:13, 716.41it/s]load dataset:  32%|███▏      | 4668/14440 [00:06<00:13, 729.60it/s]load dataset:  33%|███▎      | 4758/14440 [00:06<00:12, 774.70it/s]load dataset:  34%|███▎      | 4849/14440 [00:06<00:11, 811.59it/s]load dataset:  34%|███▍      | 4934/14440 [00:06<00:11, 822.07it/s]load dataset:  35%|███▍      | 5017/14440 [00:06<00:12, 776.20it/s]load dataset:  35%|███▌      | 5096/14440 [00:07<00:12, 772.85it/s]load dataset:  36%|███▌      | 5174/14440 [00:07<00:13, 662.72it/s]load dataset:  36%|███▋      | 5244/14440 [00:07<00:20, 457.33it/s]load dataset:  37%|███▋      | 5316/14440 [00:07<00:17, 509.48it/s]load dataset:  37%|███▋      | 5380/14440 [00:07<00:16, 537.54it/s]load dataset:  38%|███▊      | 5451/14440 [00:07<00:15, 574.08it/s]load dataset:  38%|███▊      | 5557/14440 [00:07<00:12, 696.35it/s]load dataset:  39%|███▉      | 5643/14440 [00:07<00:11, 738.52it/s]load dataset:  40%|███▉      | 5722/14440 [00:08<00:12, 698.00it/s]load dataset:  40%|████      | 5796/14440 [00:08<00:13, 626.34it/s]load dataset:  41%|████      | 5868/14440 [00:08<00:13, 648.31it/s]load dataset:  41%|████      | 5936/14440 [00:08<00:15, 560.47it/s]load dataset:  42%|████▏     | 6009/14440 [00:08<00:14, 601.73it/s]load dataset:  42%|████▏     | 6073/14440 [00:08<00:18, 461.49it/s]load dataset:  42%|████▏     | 6127/14440 [00:08<00:18, 458.80it/s]load dataset:  43%|████▎     | 6180/14440 [00:09<00:17, 475.00it/s]load dataset:  43%|████▎     | 6233/14440 [00:09<00:17, 481.48it/s]load dataset:  44%|████▎     | 6284/14440 [00:09<00:17, 478.83it/s]load dataset:  44%|████▍     | 6357/14440 [00:09<00:14, 545.42it/s]load dataset:  44%|████▍     | 6421/14440 [00:09<00:14, 569.23it/s]load dataset:  45%|████▍     | 6481/14440 [00:09<00:13, 576.32it/s]load dataset:  45%|████▌     | 6540/14440 [00:09<00:18, 430.89it/s]load dataset:  46%|████▌     | 6613/14440 [00:09<00:15, 496.35it/s]load dataset:  46%|████▌     | 6669/14440 [00:10<00:20, 376.19it/s]load dataset:  47%|████▋     | 6740/14440 [00:10<00:17, 444.43it/s]load dataset:  47%|████▋     | 6799/14440 [00:10<00:16, 463.41it/s]load dataset:  48%|████▊     | 6896/14440 [00:10<00:12, 582.04it/s]load dataset:  48%|████▊     | 6979/14440 [00:10<00:11, 633.31it/s]load dataset:  49%|████▉     | 7062/14440 [00:10<00:10, 683.96it/s]load dataset:  49%|████▉     | 7137/14440 [00:10<00:10, 700.46it/s]load dataset:  50%|████▉     | 7211/14440 [00:10<00:10, 682.20it/s]load dataset:  50%|█████     | 7283/14440 [00:11<00:10, 689.52it/s]load dataset:  51%|█████     | 7354/14440 [00:11<00:10, 689.08it/s]load dataset:  51%|█████▏    | 7425/14440 [00:11<00:11, 596.82it/s]load dataset:  52%|█████▏    | 7488/14440 [00:11<00:12, 563.64it/s]load dataset:  52%|█████▏    | 7547/14440 [00:11<00:12, 545.63it/s]load dataset:  53%|█████▎    | 7604/14440 [00:11<00:16, 422.18it/s]load dataset:  53%|█████▎    | 7652/14440 [00:11<00:16, 400.16it/s]load dataset:  54%|█████▎    | 7729/14440 [00:11<00:13, 481.19it/s]load dataset:  54%|█████▍    | 7783/14440 [00:12<00:13, 493.15it/s]load dataset:  54%|█████▍    | 7851/14440 [00:12<00:12, 537.07it/s]load dataset:  55%|█████▌    | 7944/14440 [00:12<00:10, 641.75it/s]load dataset:  55%|█████▌    | 8012/14440 [00:12<00:09, 645.92it/s]load dataset:  56%|█████▌    | 8090/14440 [00:12<00:09, 683.40it/s]load dataset:  57%|█████▋    | 8165/14440 [00:12<00:08, 700.20it/s]load dataset:  57%|█████▋    | 8237/14440 [00:12<00:10, 576.78it/s]load dataset:  58%|█████▊    | 8305/14440 [00:12<00:10, 594.72it/s]load dataset:  58%|█████▊    | 8368/14440 [00:13<00:12, 484.93it/s]load dataset:  59%|█████▊    | 8478/14440 [00:13<00:09, 627.18it/s]load dataset:  59%|█████▉    | 8549/14440 [00:13<00:09, 635.14it/s]load dataset:  60%|█████▉    | 8642/14440 [00:13<00:08, 710.04it/s]load dataset:  60%|██████    | 8733/14440 [00:13<00:07, 762.25it/s]load dataset:  61%|██████    | 8814/14440 [00:13<00:07, 770.22it/s]load dataset:  62%|██████▏   | 8904/14440 [00:13<00:06, 806.21it/s]load dataset:  62%|██████▏   | 8994/14440 [00:13<00:06, 821.07it/s]load dataset:  63%|██████▎   | 9079/14440 [00:13<00:06, 828.97it/s]load dataset:  64%|██████▎   | 9173/14440 [00:13<00:06, 861.20it/s]load dataset:  64%|██████▍   | 9261/14440 [00:14<00:06, 829.14it/s]load dataset:  65%|██████▍   | 9345/14440 [00:14<00:06, 830.86it/s]load dataset:  65%|██████▌   | 9429/14440 [00:14<00:06, 773.19it/s]load dataset:  66%|██████▌   | 9531/14440 [00:14<00:05, 830.35it/s]load dataset:  67%|██████▋   | 9616/14440 [00:14<00:05, 818.14it/s]load dataset:  67%|██████▋   | 9716/14440 [00:14<00:05, 850.45it/s]load dataset:  68%|██████▊   | 9802/14440 [00:14<00:05, 793.06it/s]load dataset:  69%|██████▊   | 9908/14440 [00:14<00:05, 865.07it/s]load dataset:  69%|██████▉   | 10018/14440 [00:14<00:04, 930.07it/s]load dataset:  70%|███████   | 10113/14440 [00:15<00:04, 893.50it/s]load dataset:  71%|███████   | 10204/14440 [00:15<00:04, 860.19it/s]load dataset:  71%|███████▏  | 10291/14440 [00:15<00:04, 841.38it/s]load dataset:  72%|███████▏  | 10376/14440 [00:15<00:04, 817.17it/s]load dataset:  72%|███████▏  | 10459/14440 [00:15<00:04, 807.17it/s]load dataset:  73%|███████▎  | 10542/14440 [00:15<00:04, 809.55it/s]load dataset:  74%|███████▎  | 10633/14440 [00:15<00:04, 836.83it/s]load dataset:  74%|███████▍  | 10723/14440 [00:15<00:04, 853.26it/s]load dataset:  75%|███████▍  | 10809/14440 [00:15<00:04, 787.68it/s]load dataset:  75%|███████▌  | 10899/14440 [00:16<00:04, 816.72it/s]load dataset:  76%|███████▌  | 11001/14440 [00:16<00:03, 871.08it/s]load dataset:  77%|███████▋  | 11090/14440 [00:16<00:03, 874.36it/s]load dataset:  77%|███████▋  | 11179/14440 [00:16<00:03, 872.93it/s]load dataset:  78%|███████▊  | 11282/14440 [00:16<00:03, 916.57it/s]load dataset:  79%|███████▉  | 11381/14440 [00:16<00:03, 937.65it/s]load dataset:  79%|███████▉  | 11476/14440 [00:16<00:03, 884.20it/s]load dataset:  80%|████████  | 11573/14440 [00:16<00:03, 908.03it/s]load dataset:  81%|████████  | 11665/14440 [00:16<00:03, 839.93it/s]load dataset:  81%|████████▏ | 11751/14440 [00:17<00:03, 820.03it/s]load dataset:  82%|████████▏ | 11845/14440 [00:17<00:03, 851.17it/s]load dataset:  83%|████████▎ | 11945/14440 [00:17<00:02, 893.16it/s]load dataset:  83%|████████▎ | 12036/14440 [00:17<00:02, 822.87it/s]load dataset:  84%|████████▍ | 12120/14440 [00:17<00:02, 807.54it/s]load dataset:  85%|████████▍ | 12204/14440 [00:17<00:02, 815.66it/s]load dataset:  85%|████████▌ | 12300/14440 [00:17<00:02, 856.07it/s]load dataset:  86%|████████▌ | 12394/14440 [00:17<00:02, 878.87it/s]load dataset:  86%|████████▋ | 12483/14440 [00:17<00:02, 780.11it/s]load dataset:  87%|████████▋ | 12564/14440 [00:18<00:02, 714.10it/s]load dataset:  88%|████████▊ | 12638/14440 [00:18<00:02, 706.59it/s]load dataset:  88%|████████▊ | 12711/14440 [00:18<00:02, 699.20it/s]load dataset:  89%|████████▊ | 12807/14440 [00:18<00:02, 767.57it/s]load dataset:  89%|████████▉ | 12894/14440 [00:18<00:01, 785.03it/s]load dataset:  90%|████████▉ | 12974/14440 [00:18<00:02, 719.62it/s]load dataset:  90%|█████████ | 13051/14440 [00:18<00:01, 731.12it/s]load dataset:  91%|█████████ | 13130/14440 [00:18<00:01, 740.41it/s]load dataset:  91%|█████████▏| 13205/14440 [00:18<00:01, 719.98it/s]load dataset:  92%|█████████▏| 13278/14440 [00:19<00:01, 708.58it/s]load dataset:  92%|█████████▏| 13350/14440 [00:19<00:01, 642.61it/s]load dataset:  93%|█████████▎| 13416/14440 [00:19<00:01, 612.24it/s]load dataset:  93%|█████████▎| 13479/14440 [00:19<00:01, 556.66it/s]load dataset:  94%|█████████▎| 13536/14440 [00:19<00:01, 528.96it/s]load dataset:  94%|█████████▍| 13606/14440 [00:19<00:01, 558.77it/s]load dataset:  95%|█████████▍| 13663/14440 [00:19<00:02, 369.55it/s]load dataset:  95%|█████████▍| 13709/14440 [00:20<00:01, 374.64it/s]load dataset:  95%|█████████▌| 13753/14440 [00:20<00:01, 370.55it/s]load dataset:  96%|█████████▌| 13797/14440 [00:20<00:01, 385.88it/s]load dataset:  96%|█████████▌| 13841/14440 [00:20<00:01, 395.04it/s]load dataset:  96%|█████████▌| 13884/14440 [00:20<00:01, 357.57it/s]load dataset:  96%|█████████▋| 13923/14440 [00:20<00:01, 263.78it/s]load dataset:  97%|█████████▋| 13955/14440 [00:20<00:01, 243.03it/s]load dataset:  97%|█████████▋| 13983/14440 [00:21<00:01, 239.07it/s]load dataset:  97%|█████████▋| 14010/14440 [00:21<00:01, 233.69it/s]load dataset:  97%|█████████▋| 14035/14440 [00:21<00:01, 227.33it/s]load dataset:  97%|█████████▋| 14061/14440 [00:21<00:01, 234.99it/s]load dataset:  98%|█████████▊| 14086/14440 [00:21<00:01, 230.83it/s]load dataset:  98%|█████████▊| 14111/14440 [00:21<00:01, 233.98it/s]load dataset:  98%|█████████▊| 14143/14440 [00:21<00:01, 256.83it/s]load dataset:  98%|█████████▊| 14188/14440 [00:21<00:00, 308.69it/s]load dataset:  98%|█████████▊| 14220/14440 [00:21<00:00, 286.77it/s]load dataset:  99%|█████████▊| 14256/14440 [00:22<00:00, 305.09it/s]load dataset:  99%|█████████▉| 14309/14440 [00:22<00:00, 366.95it/s]load dataset:  99%|█████████▉| 14347/14440 [00:22<00:00, 355.21it/s]load dataset: 100%|█████████▉| 14384/14440 [00:22<00:00, 318.78it/s]load dataset: 100%|█████████▉| 14418/14440 [00:22<00:00, 285.60it/s]load dataset: 100%|██████████| 14440/14440 [00:22<00:00, 637.81it/s]
01/01/2024 18:12:12 - INFO - __main__ -   ***** Running Test *****
01/01/2024 18:12:12 - INFO - __main__ -     Num examples = 14440
01/01/2024 18:12:12 - INFO - __main__ -     Batch size = 512
evaluate test:   0%|          | 0/29 [00:00<?, ?it/s]evaluate test:   3%|▎         | 1/29 [00:10<04:43, 10.14s/it]evaluate test:   7%|▋         | 2/29 [00:17<03:51,  8.57s/it]evaluate test:  10%|█         | 3/29 [00:25<03:30,  8.09s/it]evaluate test:  14%|█▍        | 4/29 [00:30<02:58,  7.15s/it]evaluate test:  17%|█▋        | 5/29 [00:34<02:19,  5.80s/it]evaluate test:  21%|██        | 6/29 [00:37<01:54,  4.99s/it]evaluate test:  24%|██▍       | 7/29 [00:41<01:38,  4.48s/it]evaluate test:  28%|██▊       | 8/29 [00:44<01:27,  4.15s/it]evaluate test:  31%|███       | 9/29 [00:47<01:18,  3.92s/it]evaluate test:  34%|███▍      | 10/29 [00:51<01:11,  3.77s/it]evaluate test:  38%|███▊      | 11/29 [00:54<01:05,  3.66s/it]evaluate test:  41%|████▏     | 12/29 [00:58<01:01,  3.59s/it]evaluate test:  45%|████▍     | 13/29 [01:01<00:56,  3.55s/it]evaluate test:  48%|████▊     | 14/29 [01:05<00:52,  3.51s/it]evaluate test:  52%|█████▏    | 15/29 [01:08<00:48,  3.49s/it]evaluate test:  55%|█████▌    | 16/29 [01:11<00:45,  3.47s/it]evaluate test:  59%|█████▊    | 17/29 [01:15<00:41,  3.45s/it]evaluate test:  62%|██████▏   | 18/29 [01:18<00:37,  3.43s/it]evaluate test:  66%|██████▌   | 19/29 [01:22<00:34,  3.42s/it]evaluate test:  69%|██████▉   | 20/29 [01:25<00:30,  3.41s/it]evaluate test:  72%|███████▏  | 21/29 [01:28<00:27,  3.40s/it]evaluate test:  76%|███████▌  | 22/29 [01:32<00:23,  3.40s/it]evaluate test:  79%|███████▉  | 23/29 [01:35<00:20,  3.40s/it]evaluate test:  83%|████████▎ | 24/29 [01:39<00:16,  3.40s/it]evaluate test:  86%|████████▌ | 25/29 [01:42<00:13,  3.40s/it]evaluate test:  90%|████████▉ | 26/29 [01:45<00:10,  3.41s/it]evaluate test:  93%|█████████▎| 27/29 [01:49<00:06,  3.42s/it]evaluate test:  97%|█████████▋| 28/29 [01:52<00:03,  3.43s/it]evaluate test: 100%|██████████| 29/29 [01:53<00:00,  2.61s/it]evaluate test: 100%|██████████| 29/29 [01:53<00:00,  3.92s/it]
01/01/2024 18:14:05 - INFO - __main__ -   ***** Test results *****
01/01/2024 18:14:05 - INFO - __main__ -     test_accuracy = 0.9823
01/01/2024 18:14:05 - INFO - __main__ -     test_f1 = 0.8356
01/01/2024 18:14:05 - INFO - __main__ -     test_precision = 0.9178
01/01/2024 18:14:05 - INFO - __main__ -     test_recall = 0.7669
01/01/2024 18:14:05 - INFO - __main__ -     test_threshold = 0.5
