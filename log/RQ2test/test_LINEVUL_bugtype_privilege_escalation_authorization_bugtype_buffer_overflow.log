12/25/2023 22:46:59 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at /data2/chenlida/model/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/25/2023 22:47:04 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_buffer_overflow/train.jsonl', output_dir='./saved_models/LINEVUL_bugtype_privilege_escalation_authorization', model_type='roberta', block_size=512, eval_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_buffer_overflow/valid.jsonl', test_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_buffer_overflow/test.jsonl', model_name='model.bin', model_name_or_path='/data2/chenlida/model/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='/data2/chenlida/model/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, eval_export=False, sample=False, no_cuda=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=1, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
>>>>>>>>>
./saved_models/LINEVUL_bugtype_privilege_escalation_authorization/checkpoint-best-f1/model.bin
>>>>>>>>>>

load dataset:   0%|          | 0/3729 [00:00<?, ?it/s]load dataset:   2%|▏         | 56/3729 [00:00<00:06, 552.66it/s]load dataset:   3%|▎         | 127/3729 [00:00<00:05, 633.60it/s]load dataset:   5%|▌         | 191/3729 [00:00<00:05, 594.05it/s]load dataset:   7%|▋         | 251/3729 [00:00<00:06, 519.31it/s]load dataset:   8%|▊         | 305/3729 [00:00<00:07, 437.23it/s]load dataset:   9%|▉         | 351/3729 [00:00<00:09, 364.54it/s]load dataset:  10%|█         | 390/3729 [00:00<00:10, 310.47it/s]load dataset:  11%|█▏        | 424/3729 [00:01<00:11, 275.59it/s]load dataset:  12%|█▏        | 454/3729 [00:01<00:12, 256.39it/s]load dataset:  14%|█▍        | 517/3729 [00:01<00:09, 337.52it/s]load dataset:  16%|█▌        | 580/3729 [00:01<00:07, 405.08it/s]load dataset:  17%|█▋        | 645/3729 [00:01<00:06, 466.53it/s]load dataset:  19%|█▉        | 712/3729 [00:01<00:05, 519.63it/s]load dataset:  21%|██        | 768/3729 [00:01<00:05, 513.48it/s]load dataset:  22%|██▏       | 823/3729 [00:01<00:05, 523.26it/s]load dataset:  24%|██▍       | 888/3729 [00:02<00:05, 558.77it/s]load dataset:  25%|██▌       | 946/3729 [00:02<00:05, 520.64it/s]load dataset:  27%|██▋       | 1009/3729 [00:02<00:04, 550.33it/s]load dataset:  29%|██▊       | 1066/3729 [00:02<00:05, 512.49it/s]load dataset:  30%|███       | 1119/3729 [00:02<00:05, 483.24it/s]load dataset:  32%|███▏      | 1185/3729 [00:02<00:04, 529.34it/s]load dataset:  34%|███▎      | 1254/3729 [00:02<00:04, 548.33it/s]load dataset:  35%|███▌      | 1310/3729 [00:02<00:05, 476.44it/s]load dataset:  37%|███▋      | 1362/3729 [00:02<00:04, 484.84it/s]load dataset:  38%|███▊      | 1413/3729 [00:03<00:05, 415.74it/s]load dataset:  39%|███▉      | 1458/3729 [00:03<00:05, 393.21it/s]load dataset:  41%|████      | 1516/3729 [00:03<00:05, 418.67it/s]load dataset:  42%|████▏     | 1560/3729 [00:03<00:06, 334.52it/s]load dataset:  43%|████▎     | 1615/3729 [00:03<00:05, 380.06it/s]load dataset:  46%|████▌     | 1711/3729 [00:03<00:03, 516.78it/s]load dataset:  48%|████▊     | 1795/3729 [00:03<00:03, 597.19it/s]load dataset:  50%|█████     | 1869/3729 [00:04<00:02, 632.25it/s]load dataset:  52%|█████▏    | 1937/3729 [00:04<00:03, 573.29it/s]load dataset:  54%|█████▎    | 1999/3729 [00:04<00:03, 497.70it/s]load dataset:  55%|█████▌    | 2054/3729 [00:04<00:04, 406.98it/s]load dataset:  57%|█████▋    | 2128/3729 [00:04<00:03, 476.68it/s]load dataset:  59%|█████▉    | 2195/3729 [00:04<00:02, 521.17it/s]load dataset:  61%|██████    | 2263/3729 [00:04<00:02, 560.26it/s]load dataset:  62%|██████▏   | 2324/3729 [00:04<00:02, 559.40it/s]load dataset:  65%|██████▍   | 2410/3729 [00:05<00:02, 637.99it/s]load dataset:  66%|██████▋   | 2477/3729 [00:05<00:01, 645.30it/s]load dataset:  68%|██████▊   | 2544/3729 [00:05<00:01, 615.15it/s]load dataset:  70%|███████   | 2620/3729 [00:05<00:01, 654.64it/s]load dataset:  72%|███████▏  | 2695/3729 [00:05<00:01, 679.95it/s]load dataset:  75%|███████▍  | 2790/3729 [00:05<00:01, 756.30it/s]load dataset:  77%|███████▋  | 2874/3729 [00:05<00:01, 775.99it/s]load dataset:  79%|███████▉  | 2962/3729 [00:05<00:00, 800.81it/s]load dataset:  82%|████████▏ | 3044/3729 [00:05<00:00, 801.64it/s]load dataset:  84%|████████▍ | 3125/3729 [00:05<00:00, 791.30it/s]load dataset:  86%|████████▌ | 3205/3729 [00:06<00:00, 722.63it/s]load dataset:  88%|████████▊ | 3279/3729 [00:06<00:00, 629.23it/s]load dataset:  90%|████████▉ | 3345/3729 [00:06<00:00, 583.75it/s]load dataset:  91%|█████████▏| 3406/3729 [00:06<00:00, 581.70it/s]load dataset:  93%|█████████▎| 3466/3729 [00:06<00:00, 504.07it/s]load dataset:  94%|█████████▍| 3519/3729 [00:07<00:00, 261.82it/s]load dataset:  95%|█████████▌| 3560/3729 [00:07<00:00, 174.32it/s]load dataset:  96%|█████████▋| 3591/3729 [00:07<00:00, 160.50it/s]load dataset:  97%|█████████▋| 3616/3729 [00:08<00:00, 147.00it/s]load dataset:  98%|█████████▊| 3637/3729 [00:08<00:00, 153.55it/s]load dataset:  98%|█████████▊| 3658/3729 [00:08<00:00, 148.60it/s]load dataset:  99%|█████████▊| 3677/3729 [00:08<00:00, 153.96it/s]load dataset:  99%|█████████▉| 3696/3729 [00:08<00:00, 131.56it/s]load dataset: 100%|█████████▉| 3724/3729 [00:08<00:00, 158.70it/s]load dataset: 100%|██████████| 3729/3729 [00:08<00:00, 419.95it/s]
12/25/2023 22:47:22 - INFO - __main__ -   ***** Running Test *****
12/25/2023 22:47:22 - INFO - __main__ -     Num examples = 3729
12/25/2023 22:47:22 - INFO - __main__ -     Batch size = 512
evaluate test:   0%|          | 0/8 [00:00<?, ?it/s]evaluate test:  12%|█▎        | 1/8 [00:05<00:39,  5.67s/it]evaluate test:  25%|██▌       | 2/8 [00:09<00:25,  4.33s/it]evaluate test:  38%|███▊      | 3/8 [00:12<00:19,  3.92s/it]evaluate test:  50%|█████     | 4/8 [00:15<00:14,  3.71s/it]evaluate test:  62%|██████▎   | 5/8 [00:19<00:10,  3.59s/it]evaluate test:  75%|███████▌  | 6/8 [00:22<00:07,  3.51s/it]evaluate test:  88%|████████▊ | 7/8 [00:26<00:03,  3.48s/it]evaluate test: 100%|██████████| 8/8 [00:27<00:00,  2.69s/it]evaluate test: 100%|██████████| 8/8 [00:27<00:00,  3.38s/it]
12/25/2023 22:47:49 - INFO - __main__ -   ***** Test results *****
12/25/2023 22:47:49 - INFO - __main__ -     test_accuracy = 0.963
12/25/2023 22:47:49 - INFO - __main__ -     test_f1 = 0.7137
12/25/2023 22:47:49 - INFO - __main__ -     test_precision = 0.8515
12/25/2023 22:47:49 - INFO - __main__ -     test_recall = 0.6143
12/25/2023 22:47:49 - INFO - __main__ -     test_threshold = 0.5
