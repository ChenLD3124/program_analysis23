12/25/2023 23:00:02 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at /data2/chenlida/model/codebert-base and are newly initialized: ['classifier.out_proj.bias', 'classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
12/25/2023 23:00:06 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/train.jsonl', output_dir='./saved_models/LINEVUL_bugtype_value_propagation_errors', model_type='roberta', block_size=512, eval_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/valid.jsonl', test_data_file='/data2/chenlida/work/fx/data-package/cross_sections/bug_type/bugtype_mixed/test.jsonl', model_name='model.bin', model_name_or_path='/data2/chenlida/model/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='/data2/chenlida/model/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, eval_export=False, sample=False, no_cuda=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=1, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
>>>>>>>>>
./saved_models/LINEVUL_bugtype_value_propagation_errors/checkpoint-best-f1/model.bin
>>>>>>>>>>

load dataset:   0%|          | 0/14440 [00:00<?, ?it/s]load dataset:   0%|          | 33/14440 [00:00<00:44, 324.28it/s]load dataset:   1%|          | 97/14440 [00:00<00:28, 507.34it/s]load dataset:   1%|          | 173/14440 [00:00<00:22, 621.77it/s]load dataset:   2%|▏         | 260/14440 [00:00<00:19, 718.28it/s]load dataset:   2%|▏         | 332/14440 [00:00<00:19, 707.68it/s]load dataset:   3%|▎         | 408/14440 [00:00<00:19, 722.70it/s]load dataset:   3%|▎         | 481/14440 [00:00<00:22, 626.90it/s]load dataset:   4%|▍         | 549/14440 [00:00<00:21, 640.53it/s]load dataset:   4%|▍         | 615/14440 [00:00<00:22, 615.41it/s]load dataset:   5%|▍         | 678/14440 [00:01<00:22, 619.24it/s]load dataset:   5%|▌         | 741/14440 [00:01<00:22, 603.86it/s]load dataset:   6%|▌         | 802/14440 [00:01<00:23, 589.43it/s]load dataset:   6%|▌         | 862/14440 [00:01<00:26, 511.81it/s]load dataset:   7%|▋         | 939/14440 [00:01<00:24, 556.97it/s]load dataset:   7%|▋         | 1007/14440 [00:01<00:22, 584.42it/s]load dataset:   7%|▋         | 1067/14440 [00:01<00:22, 583.15it/s]load dataset:   8%|▊         | 1131/14440 [00:01<00:22, 590.41it/s]load dataset:   8%|▊         | 1191/14440 [00:01<00:23, 560.23it/s]load dataset:   9%|▊         | 1248/14440 [00:02<00:25, 524.01it/s]load dataset:   9%|▉         | 1302/14440 [00:02<00:24, 526.51it/s]load dataset:   9%|▉         | 1360/14440 [00:02<00:24, 532.38it/s]load dataset:  10%|▉         | 1426/14440 [00:02<00:22, 567.31it/s]load dataset:  10%|█         | 1488/14440 [00:02<00:22, 581.08it/s]load dataset:  11%|█         | 1572/14440 [00:02<00:19, 655.80it/s]load dataset:  11%|█▏        | 1639/14440 [00:02<00:20, 632.87it/s]load dataset:  12%|█▏        | 1717/14440 [00:02<00:18, 674.77it/s]load dataset:  12%|█▏        | 1791/14440 [00:02<00:18, 692.37it/s]load dataset:  13%|█▎        | 1876/14440 [00:03<00:17, 732.17it/s]load dataset:  14%|█▎        | 1975/14440 [00:03<00:15, 807.23it/s]load dataset:  14%|█▍        | 2057/14440 [00:03<00:16, 742.58it/s]load dataset:  15%|█▍        | 2133/14440 [00:03<00:16, 744.94it/s]load dataset:  16%|█▌        | 2244/14440 [00:03<00:14, 847.17it/s]load dataset:  16%|█▌        | 2341/14440 [00:03<00:13, 882.02it/s]load dataset:  17%|█▋        | 2431/14440 [00:03<00:14, 818.21it/s]load dataset:  18%|█▊        | 2531/14440 [00:03<00:13, 868.31it/s]load dataset:  18%|█▊        | 2620/14440 [00:03<00:14, 839.82it/s]load dataset:  19%|█▊        | 2706/14440 [00:04<00:14, 782.54it/s]load dataset:  19%|█▉        | 2786/14440 [00:04<00:15, 736.33it/s]load dataset:  20%|█▉        | 2861/14440 [00:04<00:17, 648.39it/s]load dataset:  20%|██        | 2931/14440 [00:04<00:17, 659.19it/s]load dataset:  21%|██        | 3013/14440 [00:04<00:16, 699.45it/s]load dataset:  21%|██▏       | 3093/14440 [00:04<00:15, 725.54it/s]load dataset:  22%|██▏       | 3191/14440 [00:04<00:14, 795.36it/s]load dataset:  23%|██▎       | 3273/14440 [00:04<00:14, 778.56it/s]load dataset:  23%|██▎       | 3367/14440 [00:04<00:13, 818.01it/s]load dataset:  24%|██▍       | 3450/14440 [00:05<00:14, 758.12it/s]load dataset:  24%|██▍       | 3528/14440 [00:05<00:14, 728.12it/s]load dataset:  25%|██▍       | 3602/14440 [00:05<00:15, 721.28it/s]load dataset:  25%|██▌       | 3675/14440 [00:05<00:15, 681.56it/s]load dataset:  26%|██▌       | 3745/14440 [00:05<00:15, 683.67it/s]load dataset:  26%|██▋       | 3822/14440 [00:05<00:15, 706.16it/s]load dataset:  27%|██▋       | 3896/14440 [00:05<00:14, 715.55it/s]load dataset:  28%|██▊       | 4017/14440 [00:05<00:12, 856.01it/s]load dataset:  28%|██▊       | 4104/14440 [00:05<00:12, 797.94it/s]load dataset:  29%|██▉       | 4186/14440 [00:06<00:13, 760.48it/s]load dataset:  30%|██▉       | 4264/14440 [00:06<00:13, 755.48it/s]load dataset:  30%|███       | 4341/14440 [00:06<00:13, 739.02it/s]load dataset:  31%|███       | 4416/14440 [00:06<00:14, 692.96it/s]load dataset:  31%|███       | 4500/14440 [00:06<00:13, 732.30it/s]load dataset:  32%|███▏      | 4575/14440 [00:06<00:14, 677.49it/s]load dataset:  32%|███▏      | 4662/14440 [00:06<00:13, 728.41it/s]load dataset:  33%|███▎      | 4740/14440 [00:06<00:13, 736.21it/s]load dataset:  33%|███▎      | 4820/14440 [00:06<00:12, 752.08it/s]load dataset:  34%|███▍      | 4909/14440 [00:07<00:12, 790.99it/s]load dataset:  35%|███▍      | 4989/14440 [00:07<00:12, 734.76it/s]load dataset:  35%|███▌      | 5073/14440 [00:07<00:12, 758.12it/s]load dataset:  36%|███▌      | 5150/14440 [00:07<00:13, 670.12it/s]load dataset:  36%|███▌      | 5220/14440 [00:07<00:16, 545.75it/s]load dataset:  37%|███▋      | 5280/14440 [00:07<00:19, 467.50it/s]load dataset:  37%|███▋      | 5340/14440 [00:07<00:18, 492.88it/s]load dataset:  37%|███▋      | 5405/14440 [00:08<00:17, 529.66it/s]load dataset:  38%|███▊      | 5508/14440 [00:08<00:13, 655.25it/s]load dataset:  39%|███▉      | 5601/14440 [00:08<00:12, 724.47it/s]load dataset:  39%|███▉      | 5678/14440 [00:08<00:12, 721.49it/s]load dataset:  40%|███▉      | 5754/14440 [00:08<00:13, 645.84it/s]load dataset:  40%|████      | 5823/14440 [00:08<00:13, 627.15it/s]load dataset:  41%|████      | 5889/14440 [00:08<00:13, 612.04it/s]load dataset:  41%|████      | 5952/14440 [00:08<00:15, 543.89it/s]load dataset:  42%|████▏     | 6010/14440 [00:08<00:16, 525.20it/s]load dataset:  42%|████▏     | 6064/14440 [00:09<00:19, 435.00it/s]load dataset:  42%|████▏     | 6111/14440 [00:09<00:18, 441.50it/s]load dataset:  43%|████▎     | 6163/14440 [00:09<00:18, 459.46it/s]load dataset:  43%|████▎     | 6211/14440 [00:09<00:18, 451.56it/s]load dataset:  43%|████▎     | 6269/14440 [00:09<00:17, 470.54it/s]load dataset:  44%|████▍     | 6338/14440 [00:09<00:15, 528.34it/s]load dataset:  44%|████▍     | 6405/14440 [00:09<00:14, 562.23it/s]load dataset:  45%|████▍     | 6463/14440 [00:09<00:14, 548.27it/s]load dataset:  45%|████▌     | 6519/14440 [00:10<00:18, 419.75it/s]load dataset:  46%|████▌     | 6591/14440 [00:10<00:16, 487.36it/s]load dataset:  46%|████▌     | 6645/14440 [00:10<00:21, 360.77it/s]load dataset:  46%|████▋     | 6706/14440 [00:10<00:18, 411.06it/s]load dataset:  47%|████▋     | 6774/14440 [00:10<00:16, 470.58it/s]load dataset:  47%|████▋     | 6829/14440 [00:10<00:15, 482.61it/s]load dataset:  48%|████▊     | 6945/14440 [00:10<00:11, 653.33it/s]load dataset:  49%|████▊     | 7017/14440 [00:11<00:11, 645.01it/s]load dataset:  49%|████▉     | 7115/14440 [00:11<00:10, 730.97it/s]load dataset:  50%|████▉     | 7193/14440 [00:11<00:11, 652.40it/s]load dataset:  50%|█████     | 7263/14440 [00:11<00:11, 630.09it/s]load dataset:  51%|█████     | 7331/14440 [00:11<00:11, 641.20it/s]load dataset:  51%|█████▏    | 7401/14440 [00:11<00:10, 651.90it/s]load dataset:  52%|█████▏    | 7468/14440 [00:11<00:11, 590.15it/s]load dataset:  52%|█████▏    | 7542/14440 [00:11<00:11, 620.23it/s]load dataset:  53%|█████▎    | 7606/14440 [00:12<00:15, 451.26it/s]load dataset:  53%|█████▎    | 7659/14440 [00:12<00:15, 425.22it/s]load dataset:  54%|█████▎    | 7730/14440 [00:12<00:13, 486.22it/s]load dataset:  54%|█████▍    | 7785/14440 [00:12<00:13, 497.99it/s]load dataset:  54%|█████▍    | 7842/14440 [00:12<00:12, 516.08it/s]load dataset:  55%|█████▍    | 7897/14440 [00:12<00:14, 466.58it/s]load dataset:  55%|█████▌    | 7951/14440 [00:12<00:13, 482.50it/s]load dataset:  55%|█████▌    | 8002/14440 [00:12<00:14, 429.41it/s]load dataset:  56%|█████▌    | 8048/14440 [00:13<00:19, 323.62it/s]load dataset:  56%|█████▌    | 8106/14440 [00:13<00:16, 376.56it/s]load dataset:  57%|█████▋    | 8170/14440 [00:13<00:14, 430.21it/s]load dataset:  57%|█████▋    | 8219/14440 [00:13<00:18, 334.88it/s]load dataset:  57%|█████▋    | 8273/14440 [00:13<00:16, 376.63it/s]load dataset:  58%|█████▊    | 8318/14440 [00:13<00:21, 284.68it/s]load dataset:  58%|█████▊    | 8356/14440 [00:14<00:20, 299.40it/s]load dataset:  58%|█████▊    | 8421/14440 [00:14<00:16, 372.82it/s]load dataset:  59%|█████▉    | 8491/14440 [00:14<00:13, 445.47it/s]load dataset:  59%|█████▉    | 8543/14440 [00:14<00:13, 446.64it/s]load dataset:  60%|█████▉    | 8604/14440 [00:14<00:12, 486.05it/s]load dataset:  60%|█████▉    | 8657/14440 [00:14<00:11, 482.75it/s]load dataset:  60%|██████    | 8717/14440 [00:14<00:11, 511.94it/s]load dataset:  61%|██████    | 8774/14440 [00:14<00:10, 519.71it/s]load dataset:  61%|██████    | 8838/14440 [00:14<00:10, 549.93it/s]load dataset:  62%|██████▏   | 8909/14440 [00:15<00:09, 591.53it/s]load dataset:  62%|██████▏   | 8994/14440 [00:15<00:08, 654.72it/s]load dataset:  63%|██████▎   | 9073/14440 [00:15<00:07, 688.09it/s]load dataset:  63%|██████▎   | 9167/14440 [00:15<00:06, 756.04it/s]load dataset:  64%|██████▍   | 9244/14440 [00:15<00:08, 647.93it/s]load dataset:  64%|██████▍   | 9312/14440 [00:15<00:08, 633.03it/s]load dataset:  65%|██████▍   | 9378/14440 [00:15<00:08, 564.21it/s]load dataset:  65%|██████▌   | 9437/14440 [00:15<00:09, 555.83it/s]load dataset:  66%|██████▌   | 9531/14440 [00:15<00:07, 642.81it/s]load dataset:  67%|██████▋   | 9610/14440 [00:16<00:07, 678.02it/s]load dataset:  67%|██████▋   | 9700/14440 [00:16<00:06, 738.06it/s]load dataset:  68%|██████▊   | 9776/14440 [00:16<00:06, 675.13it/s]load dataset:  68%|██████▊   | 9880/14440 [00:16<00:05, 767.47it/s]load dataset:  69%|██████▉   | 9991/14440 [00:16<00:05, 861.32it/s]load dataset:  70%|██████▉   | 10080/14440 [00:16<00:05, 853.95it/s]load dataset:  70%|███████   | 10168/14440 [00:16<00:05, 769.27it/s]load dataset:  71%|███████   | 10249/14440 [00:16<00:05, 776.06it/s]load dataset:  72%|███████▏  | 10329/14440 [00:16<00:05, 737.23it/s]load dataset:  72%|███████▏  | 10414/14440 [00:17<00:05, 767.12it/s]load dataset:  73%|███████▎  | 10493/14440 [00:17<00:05, 742.73it/s]load dataset:  73%|███████▎  | 10571/14440 [00:17<00:05, 752.05it/s]load dataset:  74%|███████▍  | 10665/14440 [00:17<00:04, 803.10it/s]load dataset:  74%|███████▍  | 10747/14440 [00:17<00:04, 798.48it/s]load dataset:  75%|███████▍  | 10828/14440 [00:17<00:04, 780.85it/s]load dataset:  76%|███████▌  | 10917/14440 [00:17<00:04, 806.54it/s]load dataset:  76%|███████▌  | 11007/14440 [00:17<00:04, 832.90it/s]load dataset:  77%|███████▋  | 11094/14440 [00:17<00:03, 841.96it/s]load dataset:  77%|███████▋  | 11183/14440 [00:18<00:03, 853.71it/s]load dataset:  78%|███████▊  | 11278/14440 [00:18<00:03, 878.49it/s]load dataset:  79%|███████▉  | 11373/14440 [00:18<00:03, 898.23it/s]load dataset:  79%|███████▉  | 11463/14440 [00:18<00:03, 843.70it/s]load dataset:  80%|████████  | 11555/14440 [00:18<00:03, 861.44it/s]load dataset:  81%|████████  | 11642/14440 [00:18<00:03, 848.53it/s]load dataset:  81%|████████  | 11728/14440 [00:18<00:03, 781.94it/s]load dataset:  82%|████████▏ | 11828/14440 [00:18<00:03, 830.58it/s]load dataset:  83%|████████▎ | 11914/14440 [00:18<00:03, 837.84it/s]load dataset:  83%|████████▎ | 12001/14440 [00:18<00:02, 841.28it/s]load dataset:  84%|████████▎ | 12086/14440 [00:19<00:02, 796.12it/s]load dataset:  84%|████████▍ | 12169/14440 [00:19<00:02, 805.41it/s]load dataset:  85%|████████▍ | 12251/14440 [00:19<00:02, 780.52it/s]load dataset:  85%|████████▌ | 12330/14440 [00:19<00:02, 775.36it/s]load dataset:  86%|████████▌ | 12415/14440 [00:19<00:02, 795.21it/s]load dataset:  87%|████████▋ | 12495/14440 [00:19<00:02, 713.87it/s]load dataset:  87%|████████▋ | 12569/14440 [00:19<00:02, 696.85it/s]load dataset:  88%|████████▊ | 12640/14440 [00:19<00:02, 685.23it/s]load dataset:  88%|████████▊ | 12710/14440 [00:20<00:02, 679.82it/s]load dataset:  89%|████████▊ | 12796/14440 [00:20<00:02, 728.83it/s]load dataset:  89%|████████▉ | 12887/14440 [00:20<00:01, 778.91it/s]load dataset:  90%|████████▉ | 12966/14440 [00:20<00:02, 710.87it/s]load dataset:  90%|█████████ | 13046/14440 [00:20<00:01, 729.09it/s]load dataset:  91%|█████████ | 13124/14440 [00:20<00:01, 739.77it/s]load dataset:  91%|█████████▏| 13199/14440 [00:20<00:01, 689.69it/s]load dataset:  92%|█████████▏| 13270/14440 [00:20<00:01, 695.14it/s]load dataset:  92%|█████████▏| 13341/14440 [00:20<00:01, 622.24it/s]load dataset:  93%|█████████▎| 13406/14440 [00:21<00:01, 588.63it/s]load dataset:  93%|█████████▎| 13467/14440 [00:21<00:01, 564.76it/s]load dataset:  94%|█████████▎| 13525/14440 [00:21<00:01, 514.15it/s]load dataset:  94%|█████████▍| 13600/14440 [00:21<00:01, 568.37it/s]load dataset:  95%|█████████▍| 13659/14440 [00:21<00:02, 329.16it/s]load dataset:  95%|█████████▍| 13705/14440 [00:21<00:02, 310.84it/s]load dataset:  95%|█████████▌| 13748/14440 [00:22<00:02, 332.37it/s]load dataset:  95%|█████████▌| 13789/14440 [00:22<00:01, 347.38it/s]load dataset:  96%|█████████▌| 13830/14440 [00:22<00:01, 361.27it/s]load dataset:  96%|█████████▌| 13871/14440 [00:22<00:01, 363.00it/s]load dataset:  96%|█████████▋| 13911/14440 [00:22<00:02, 256.35it/s]load dataset:  97%|█████████▋| 13945/14440 [00:22<00:01, 271.09it/s]load dataset:  97%|█████████▋| 13978/14440 [00:22<00:02, 220.54it/s]load dataset:  97%|█████████▋| 14005/14440 [00:23<00:01, 219.31it/s]load dataset:  97%|█████████▋| 14032/14440 [00:23<00:01, 217.10it/s]load dataset:  97%|█████████▋| 14059/14440 [00:23<00:01, 224.11it/s]load dataset:  98%|█████████▊| 14084/14440 [00:23<00:01, 221.96it/s]load dataset:  98%|█████████▊| 14110/14440 [00:23<00:01, 228.64it/s]load dataset:  98%|█████████▊| 14141/14440 [00:23<00:01, 248.20it/s]load dataset:  98%|█████████▊| 14194/14440 [00:23<00:00, 322.56it/s]load dataset:  99%|█████████▊| 14228/14440 [00:23<00:00, 315.43it/s]load dataset:  99%|█████████▉| 14263/14440 [00:24<00:00, 313.91it/s]load dataset:  99%|█████████▉| 14317/14440 [00:24<00:00, 375.82it/s]load dataset:  99%|█████████▉| 14356/14440 [00:24<00:00, 353.18it/s]load dataset: 100%|█████████▉| 14393/14440 [00:24<00:00, 283.07it/s]load dataset: 100%|█████████▉| 14433/14440 [00:24<00:00, 308.53it/s]load dataset: 100%|██████████| 14440/14440 [00:24<00:00, 588.35it/s]
12/25/2023 23:00:36 - INFO - __main__ -   ***** Running Test *****
12/25/2023 23:00:36 - INFO - __main__ -     Num examples = 14440
12/25/2023 23:00:36 - INFO - __main__ -     Batch size = 512
evaluate test:   0%|          | 0/29 [00:00<?, ?it/s]evaluate test:   3%|▎         | 1/29 [00:04<02:12,  4.72s/it]evaluate test:   7%|▋         | 2/29 [00:08<01:46,  3.95s/it]evaluate test:  10%|█         | 3/29 [00:11<01:36,  3.69s/it]evaluate test:  14%|█▍        | 4/29 [00:14<01:29,  3.58s/it]evaluate test:  17%|█▋        | 5/29 [00:18<01:24,  3.54s/it]evaluate test:  21%|██        | 6/29 [00:21<01:20,  3.49s/it]evaluate test:  24%|██▍       | 7/29 [00:25<01:16,  3.46s/it]evaluate test:  28%|██▊       | 8/29 [00:28<01:12,  3.44s/it]evaluate test:  31%|███       | 9/29 [00:31<01:08,  3.43s/it]evaluate test:  34%|███▍      | 10/29 [00:35<01:05,  3.44s/it]evaluate test:  38%|███▊      | 11/29 [00:38<01:01,  3.44s/it]evaluate test:  41%|████▏     | 12/29 [00:42<00:59,  3.47s/it]evaluate test:  45%|████▍     | 13/29 [00:45<00:55,  3.46s/it]evaluate test:  48%|████▊     | 14/29 [00:49<00:51,  3.45s/it]evaluate test:  52%|█████▏    | 15/29 [00:52<00:48,  3.44s/it]evaluate test:  55%|█████▌    | 16/29 [00:56<00:44,  3.44s/it]evaluate test:  59%|█████▊    | 17/29 [00:59<00:41,  3.43s/it]evaluate test:  62%|██████▏   | 18/29 [01:02<00:37,  3.42s/it]evaluate test:  66%|██████▌   | 19/29 [01:06<00:34,  3.42s/it]evaluate test:  69%|██████▉   | 20/29 [01:09<00:30,  3.42s/it]evaluate test:  72%|███████▏  | 21/29 [01:13<00:27,  3.42s/it]evaluate test:  76%|███████▌  | 22/29 [01:16<00:23,  3.41s/it]evaluate test:  79%|███████▉  | 23/29 [01:20<00:20,  3.41s/it]evaluate test:  83%|████████▎ | 24/29 [01:23<00:17,  3.41s/it]evaluate test:  86%|████████▌ | 25/29 [01:26<00:13,  3.42s/it]evaluate test:  90%|████████▉ | 26/29 [01:30<00:10,  3.43s/it]evaluate test:  93%|█████████▎| 27/29 [01:33<00:06,  3.43s/it]evaluate test:  97%|█████████▋| 28/29 [01:37<00:03,  3.44s/it]evaluate test: 100%|██████████| 29/29 [01:37<00:00,  2.63s/it]evaluate test: 100%|██████████| 29/29 [01:37<00:00,  3.38s/it]
12/25/2023 23:02:14 - INFO - __main__ -   ***** Test results *****
12/25/2023 23:02:14 - INFO - __main__ -     test_accuracy = 0.9747
12/25/2023 23:02:14 - INFO - __main__ -     test_f1 = 0.7488
12/25/2023 23:02:14 - INFO - __main__ -     test_precision = 0.8947
12/25/2023 23:02:14 - INFO - __main__ -     test_recall = 0.6438
12/25/2023 23:02:14 - INFO - __main__ -     test_threshold = 0.5
